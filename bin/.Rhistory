setwd("~/Google Drive/Ana+Camille/amptk_pipeline/bin")
# Import biom data (includes otu table, taxonomy table and sample data)
phyloseq_tables <- import_biom("../data/taxonomy.biom")
library("plyr"); packageVersion("plyr")
library("phyloseq"); packageVersion("phyloseq")
library("ggplot2"); packageVersion("ggplot2")
library("vegan"); packageVersion("vegan")
library("RColorBrewer"); packageVersion("RColorBrewer")
library("plotly"); packageVersion("plotly")
library("htmltools"); packageVersion("htmltools")
library("DT"); packageVersion("DT")
library(ggplot2)
library(dplyr)
library(tibble)
# Get colors and theme set
display.brewer.all(type="seq")
display.brewer.all(type="div")
display.brewer.all(type="qual")
theme_set(theme_bw())
# Import biom data (includes otu table, taxonomy table and sample data)
phyloseq_tables <- import_biom("../data/taxonomy.biom")
phyloseq_tables
setwd("~/Google Drive/Ana+Camille/amptk_pipeline/bin")
source("../bin/1_Filter_otu_table.R")
library("plyr"); packageVersion("plyr")
library("phyloseq"); packageVersion("phyloseq")
library("ggplot2"); packageVersion("ggplot2")
library("vegan"); packageVersion("vegan")
library("RColorBrewer"); packageVersion("RColorBrewer")
library("plotly"); packageVersion("plotly")
library("htmltools"); packageVersion("htmltools")
library("DT"); packageVersion("DT")
library(ggplot2)
library(dplyr)
library(tibble)
# Subset data for Texcoco using relative abundance
subset.texcoco.alfa <- subset_samples(phyloseq.rel, Site%in%c("mixed", "perturbated", "native"))
subset.texcoco.alfa
sample_data(subset.texcoco.alfa)
sample_sums(subset.texcoco.alfa) [1:10]
# Should we remove OTUs that are not present in any of the samples of the subset? (OTUs that are only present either in Izta or Texcoco)
taxa_sums(subset.texcoco.alfa) [1:10]
subset.texcoco.alfa <- prune_taxa(taxa_sums(subset.texcoco.alfa) > 0, subset.texcoco.alfa)
any(taxa_sums(subset.texcoco.alfa) == 0)
taxa_sums(subset.texcoco.alfa) [1:10]
subset.texcoco.alfa
subset.texcoco.binary <- subset_samples(binary_table, Site%in%c("mixed", "perturbated", "native"))
subset.texcoco.binary
sample_data(subset.texcoco.binary)
#Should we remove OTUs that are not present in any of the samples of the subset? (OTUs that are only present either in Izta or Texcoco) if we do, do it in alpha diversity and beta diversity analysis?
taxa_sums(subset.texcoco.binary) [1:10]
subset.texcoco.binary<- prune_taxa(taxa_sums(subset.texcoco.binary) > 0, subset.texcoco.binary)
subset.texcoco.binary
library("plyr"); packageVersion("plyr")
library("phyloseq"); packageVersion("phyloseq")
library("ggplot2"); packageVersion("ggplot2")
library("vegan"); packageVersion("vegan")
library("RColorBrewer"); packageVersion("RColorBrewer")
library("plotly"); packageVersion("plotly")
library("htmltools"); packageVersion("htmltools")
library("DT"); packageVersion("DT")
library(ggplot2)
library(dplyr)
library(tibble)
theme_set(theme_bw())
setwd("~/Google Drive/Ana+Camille/amptk_pipeline/bin")
source("../bin/1_Filter_otu_table.R")
#By site: Texcoco.
subset.texcoco.binary.beta <- subset_samples(binary_table_OTU2, Site%in%c("mixed", "perturbated", "native"))
subset.texcoco.binary.beta
sample_data(subset.texcoco.binary.beta)
#By site Izta
subset.izta.binary.beta <- subset_samples(binary_table_OTU2, Site%in%c("Joya", "Cueva", "Base"))
subset.izta.binary.beta
sample_data(subset.izta.binary.beta)
#NMDS Bray Texcoco
bray_nmds = distance(subset.texcoco.binary.beta, method = "bray")
ordination = ordinate(subset.texcoco.binary.beta, method = "NMDS", distance = bray_nmds)
p1 <- plot_ordination(subset.texcoco.binary.beta, ordination, color="Species", shape = "Type", title = "") + theme(aspect.ratio=1)+geom_point(size=3)
print(p1)
